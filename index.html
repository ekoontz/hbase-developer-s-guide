<html>
  <head>
    <!-- CSS : implied media="all" -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/hbase_dev_guide.css">
    
    <!-- For the less-enabled mobile browsers like Opera Mini -->
    <link rel="stylesheet" media="handheld" href="css/handheld.css?v=1">
    <title>HBase Dev Guide</title>
  </head>
  <body>
    <h1 "text-align:center;width:100%;float:left">HBase Dev Guide</h1>
    <h2>Author: Eugene Koontz et. al.</h2>
    <h1>Introduction</h1>
    <p>This guide is intended to help you get started with developing
    with Hbase.</p>

    <h1>VirtualBox instance setup</h1>
    <h2>Create your own</h2>
    <p>
      It is a good learning exercise to make your own Linux
      images. If you are using Debian or Ubuntu, this is a
      superset of the <a href="dpkg.txt">list of packages you
	    need</a>.
    </p>

    <p> Note that
      this is a superset, some packages in this list are not
      necessary for running HBase, but I wanted to install them
      for some reason.
    </p>
    
    <h3>Dependencies</h3>
    
    <p>In essence you want a linux server install with:</p>
    <ul>
      <li>opensshd</li>
      <li>git (<code>apt-get install git core</code>)</li>
      <li>JDK (<code>apt-get install default-jdk</code>)</li>
      <li>Apache Maven (<code>apt-get install maven2</code>)</li>
    </ul>
    
    <p> Note that ubuntu's <code>default-jdk</code> installs OpenJDK, although Hbase officially
      recommends the Sun (now Oracle) JDK).</p>

    <p>This is a small subset of what HBase needs, but when we
      run Maven (see <b>Compilation</b> below), it will pull in
      all of the remaining prerequisites and store them in
      your <code>~/.m2</code> directory.
    </p>
    
    <p> I would like to do a more thorough analysis of the
      dependency graph in order to make the image and
      comprehensible as possible. One of the packages with the
      most dependencies might be <code>maven2</code>. Here is
      the dependency graph for <code>maven2</code>:(
      <a href="maven2.png"><code>.png</code></a>,
      <a href="maven2.dot"><code>.dot</code></a>). 
    </p>
      
      <h2>Eugene's Virtualbox images download</h2>
      
    <p>(add link to virtualbox images..hopefully won't be too
      huge to host somewhere..)</p>


    <h1>Kerberos setup (optional)</h1>

    <h2>Kerberos dependencies</h2>
    
    <p>If you want to use the Secure HBase functionality
      which is starting to become available, you will also want
      to install:</p>

    <ul>
      <li>krb5 (client)</li>
      <li>krb5 (server) (for at least one machine
	(the Ticket Granting instance)).</li>
      <li>DNS (server) for one machine</li>
      <li>DNS (client) for other machines</li>
      <li>NTP (server) for one machine</li>
      <li>NTP (client) for other machines</li>
    </ul>

    <h2>Kerberos setup</h2>
    <h3>Kerberos Realm and Admin Server</h3>
    <p>You could install the Realm and Admin server on separate
    servers, but we'll just install them both on one for simplicity of
    explanation. Do: <code>apt-get install krb5-server</code>
    </p>

    <img src="realm_servers.png"/>
    <img src="realm.png"/>
    <img src="admin_server.png"/>
    
    <h1>HDFS Compilation</h1>

      <h2>Hadoop Git repository</h2>

      <p>Substitute your github username for <code>myuser</code> below:</p>

      <pre class="block">
	git clone http://github.com/myuser/hadoop-common
	git clone http://github.com/myuser/hadoop-hdfs
      </pre>

      <h1>HDFS Startup</h1>
      
      <h2>Authentication (optional)</h2>
      
    <p>This is required if you want to use Secure Hadoop and Secure HBase.</p>
    
    <h1>HDFS Test</h1>
    
    <h2>Authentication (optional)</h2>
    
    <h1>HBase Compilation</h1>
      
      <h2>HBase Git repository</h2>

      <p>
      Substitute your github username for <code>myuser</code> below:
      </p>

      <pre class="block">
	git clone http://github.com/myuser/hbase
      </pre>

      <h2>HBase Startup</h2>

      <h3>Hadoop development <code>CLASSPATH</code> setting</h3>

      <p>This step allows you to control your Hadoop environment. For
      example, if you want to develop with Secure Hadoop, you'll want
      to explore the Hadoop/Kerberos communication, so you'll want to
      make sure that HBase is using the Hadoop that you're looking at
      in your Hadoop source directory (above)</p>

      <p>Add the following to your bin/hbase:</p>

      <pre class="block">
	if [ "$DEV_MODE" = "1" ] ; then
            CLASSPATH=~/hadoop-common/build/classes:~/hadoop-hdfs/build/classes:$CLASSPATH
	fi
      </pre>

      <h1>Runtime inspection of HBase</h1>
    <p>
      I prefer Intellij IDEA rather than Eclipse, but would welcome
      someone writing an Eclipse guide and adding it here (using
      CC:attribute licence).
    </p>
        <h2>Intellij</h2>


        <h3>Intellij: Attaching to remote instances</h3>
   
	<p>
	Intellij uses the Java debug machinery (enabled with):

	<pre class="block">
	  -Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=y,address=5006
	</pre>
	
	<p>
	to interactively debug Java processes running on remote
	machines. This is great because it lets you run your desktop
	operating system of choice (be it Mac OS X, Linux, or Windows)
	as your development environment, but still run your compiled
	runtime on Linux, which is required if you want to run HBase
	according to its <a href="http://hbase.org/">official
	Recommendations</a>.


	<h1>Testing</h1>

	<p>As you add new functionality to Hbase, be sure to add tests
	to the <code>src/tests</code> directory, and to make sure
	existing tests pass, using <code>mvn test</code>.</p>

	<h2>Using EC2 for testing</h2>
	<p>Running all unit tests takes a long time; therefore, you
	might want a fast, dedicated server, or on Amazon EC2 large
	(or better) instance.</p>


  </body>
</html>
